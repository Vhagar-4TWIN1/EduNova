import{u as C,r as c,a as w,j as o,b as e,F as v,c as N,d as P}from"./index-C3nL3Q8Y.js";const I="/assets/video-CHP8KpQe.mp4",x="78ugv1m0uyomhw",L="http://localhost:5173/auth/linkedin/callback",E=()=>{const h=C(),[u,i]=c.useState(!1),[m,n]=c.useState(""),[p,b]=c.useState(!1),[g,k]=c.useState(!1),[t,y]=c.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:"",age:"",country:"",role:"Student",idUser:Math.floor(1e5+Math.random()*9e5).toString()});c.useEffect(()=>{localStorage.getItem("token")&&h("/")},[h]),c.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("code");s&&(console.log("Authorization code received from LinkedIn:",s),i(!0),w.post("http://localhost:3000/api/auth/linkedinAuth",{code:s}).then(a=>{console.log("LinkedIn OAuth response:",a.data),a.data.token?(console.log("User authenticated successfully."),localStorage.setItem("token",a.data.token),y({...t,firstName:a.data.firstName||"",lastName:a.data.lastName||"",email:a.data.email||""})):n("No token received from LinkedIn")}).catch(a=>{console.error("Error during LinkedIn OAuth process:",a),n("LinkedIn authentication failed")}).finally(()=>{i(!1)}))},[]);const S=()=>{console.log("Redirecting to LinkedIn for authentication..."),i(!0);const l=`https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=${x}&redirect_uri=${encodeURIComponent(L)}&scope=profile%20email`;window.location.href=l},r=l=>{const{name:s,value:a}=l.target;y(d=>({...d,[s]:a})),m&&n("")};return o("div",{className:"login-main",children:[e("div",{className:"login-left",children:o("video",{autoPlay:!0,loop:!0,muted:!0,className:"background-video",children:[e("source",{src:I,type:"video/mp4"}),"Your browser does not support the video tag."]})}),e("div",{className:"login-right",children:o("div",{className:"login-right-container",children:[o("div",{className:"login-center",children:[e("h2",{children:"Create your account"}),e("p",{children:"Please enter your details"}),m&&e("p",{className:"error-message",style:{color:"red"},children:m}),o("form",{onSubmit:async l=>{var s,a;if(l.preventDefault(),i(!0),n(""),t.password!==t.confirmPassword){n("Passwords do not match"),i(!1);return}if(isNaN(t.age)||t.age<=0){n("Please enter a valid age"),i(!1);return}try{const d={firstName:t.firstName,lastName:t.lastName,email:t.email,password:t.password,age:Number(t.age),country:t.country,role:t.role,idUser:t.idUser};console.log("Signing up with data:",d);const f=await w.post("http://localhost:3000/api/auth/signup",d);f.data.success?(console.log("Registration successful:",f.data),h("/")):n(f.data.message||"Registration failed")}catch(d){console.error("Registration error:",d),n(((a=(s=d.response)==null?void 0:s.data)==null?void 0:a.message)||"Registration failed. Please try again.")}finally{i(!1)}},children:[e("input",{type:"text",placeholder:"First Name",name:"firstName",value:t.firstName,onChange:r,required:!0}),e("input",{type:"text",placeholder:"Last Name",name:"lastName",value:t.lastName,onChange:r,required:!0}),e("input",{type:"email",placeholder:"Email",name:"email",value:t.email,onChange:r,required:!0}),o("div",{style:{position:"relative"},children:[e("input",{type:p?"text":"password",placeholder:"Password",name:"password",value:t.password,onChange:r,required:!0}),e("button",{type:"button",onClick:()=>b(!p),style:{position:"absolute",top:"50%",right:"10px",transform:"translateY(-50%)",background:"transparent",border:"none",cursor:"pointer"},children:p?e(v,{}):e(N,{})})]}),o("div",{style:{position:"relative"},children:[e("input",{type:g?"text":"password",placeholder:"Confirm Password",name:"confirmPassword",value:t.confirmPassword,onChange:r,required:!0}),e("button",{type:"button",onClick:()=>k(!g),style:{position:"absolute",top:"50%",right:"10px",transform:"translateY(-50%)",background:"transparent",border:"none",cursor:"pointer"},children:g?e(v,{}):e(N,{})})]}),e("input",{type:"number",placeholder:"Age",name:"age",value:t.age,onChange:r,required:!0}),e("input",{type:"text",placeholder:"Country",name:"country",value:t.country,onChange:r,required:!0}),o("select",{name:"role",value:t.role,onChange:r,required:!0,style:{padding:"10px",marginBottom:"15px",width:"100%",borderRadius:"5px",border:"1px solid #ddd"},children:[e("option",{value:"Student",children:"Student"}),e("option",{value:"Teacher",children:"Teacher"}),e("option",{value:"Admin",children:"Admin"})]}),o("div",{className:"login-center-buttons",children:[e("button",{type:"submit",disabled:u,children:u?"Processing...":"Sign Up"}),e("button",{type:"button",onClick:S,disabled:u,children:u?"Redirecting...":"Sign Up with LinkedIn"})]})]})]}),o("p",{className:"login-bottom-p",children:["Already have an account? ",e(P,{to:"/login",children:"Log in"})]})]})})]})};export{E as default};
