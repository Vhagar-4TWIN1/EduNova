import{U as K,S as Y,r as c,W as Z,_ as I,b as e,Z as Q,E as S,V as J,a0 as N,a3 as B,at as X,au as A,z as ee,j as k,av as te,$ as oe,D as re,ab as j,ad as ne,a4 as T,ak as se,ai as ae,x as le,al as ie,u as ce,a5 as ue,ar as de}from"./index-C3nL3Q8Y.js";import{H as pe}from"./header-B5dyLMZC.js";import{u as R,c as me,g as W,b as _,d as L,e as H,G as M,f as $,h as he,i as fe,j as be,k as ge,l as xe,B as ye,m as Ce,n as ve,o as O,p as we,q as Se,a as Te,D as De}from"./Delete-BDaq_0IK.js";import{r as Fe,a as ke}from"./jsx-runtime_commonjs-proxy-P7gUQ3kO.js";import{u as Pe}from"./useMediaQuery-C8Pft0E8.js";import{A as U}from"./Alert-ByAO8-9K.js";import{B as q}from"./Button-Dg9Z3r8Z.js";import{M as Ie}from"./MenuItem-NIEDGLUA.js";import{L as Le}from"./ListItemIcon-B0w8Y66k.js";import{D as Re,a as Ee,b as $e,c as Ge}from"./DialogTitle-e9mnjx1x.js";import"./Close-ChL254u0.js";import"./Tooltip-BYEiyJU_.js";import"./ClickAwayListener-C_h-5Qdg.js";import"./useThemeProps-CRU2mqAJ.js";import"./getThemeProps-DLbyqOGa.js";import"./FormControlLabel-BHfDsEEE.js";import"./Stack-CAonYs3f.js";import"./LastPage-GdtTYewh.js";import"./TableCell-B1lZrvz4.js";import"./listItemTextClasses-B7Ux6p96.js";function Ve(t){return K("MuiDialogContentText",t)}Y("MuiDialogContentText",["root"]);const qe=["children","className"],Be=t=>{const{classes:o}=t,i=N({root:["root"]},Ve,o);return S({},o,i)},Qe=Q(B,{shouldForwardProp:t=>X(t)||t==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(t,o)=>o.root})({}),_e=c.forwardRef(function(o,u){const i=Z({props:o,name:"MuiDialogContentText"}),{className:m}=i,h=I(i,qe),n=Be(h);return e(Qe,S({component:"p",variant:"body1",color:"text.secondary",ref:u,ownerState:h,className:J(n.root,m)},i,{classes:n}))}),Me=["className","children"],Ne=t=>{const{classes:o}=t;return N({root:["toolbarContainer"]},W,o)},Ae=Q("div",{name:"MuiDataGrid",slot:"ToolbarContainer",overridesResolver:(t,o)=>o.toolbarContainer})(({theme:t})=>({display:"flex",alignItems:"center",flexWrap:"wrap",padding:t.spacing(.5,.5,0)})),Oe=c.forwardRef(function(o,u){const{className:i,children:m}=o,h=I(o,Me),n=R(),r=Ne(n);return m?e(Ae,S({ref:u,className:me(i,r.root),ownerState:n},h,{children:m})):null}),Ue=["onClick"],ze=c.forwardRef(function(o,u){var i;const{onClick:m}=o,h=I(o,Ue),n=_(),r=R(),{open:s,openedPanelValue:p}=L(n,H),g=x=>{s&&p===M.columns?n.current.hidePreferences():n.current.showPreferences(M.columns),m==null||m(x)};return r.disableColumnSelector?null:e(r.components.BaseButton,S({ref:u,size:"small","aria-label":n.current.getLocaleText("toolbarColumnsLabel"),startIcon:e(r.components.ColumnSelectorIcon,{})},h,{onClick:g},(i=r.componentsProps)==null?void 0:i.baseButton,{children:n.current.getLocaleText("toolbarColumns")}))}),je=["onClick"],We=c.forwardRef(function(o,u){var i;const{onClick:m}=o,h=I(o,je),n=_(),r=R(),s=L(n,be),p=A(),g=A(),[x,v]=c.useState(!1),C=c.useRef(null),F=ee(u,C),P=[{icon:e(r.components.DensityCompactIcon,{}),label:n.current.getLocaleText("toolbarDensityCompact"),value:$.Compact},{icon:e(r.components.DensityStandardIcon,{}),label:n.current.getLocaleText("toolbarDensityStandard"),value:$.Standard},{icon:e(r.components.DensityComfortableIcon,{}),label:n.current.getLocaleText("toolbarDensityComfortable"),value:$.Comfortable}],D=c.useMemo(()=>{switch(s){case $.Compact:return e(r.components.DensityCompactIcon,{});case $.Comfortable:return e(r.components.DensityComfortableIcon,{});default:return e(r.components.DensityStandardIcon,{})}},[s,r]),y=l=>{v(b=>!b),m==null||m(l)},d=l=>{var b;C.current===l.target||(b=C.current)!=null&&b.contains(l.target)||v(!1)},w=l=>{n.current.setDensity(l),v(!1)},a=l=>{ge(l.key)&&l.preventDefault(),xe(l.key)&&v(!1)};if(r.disableDensitySelector)return null;const f=P.map((l,b)=>k(Ie,{onClick:()=>w(l.value),selected:l.value===s,children:[e(Le,{children:l.icon}),l.label]},b));return k(c.Fragment,{children:[e(r.components.BaseButton,S({ref:F,size:"small",startIcon:D,"aria-label":n.current.getLocaleText("toolbarDensityLabel"),"aria-expanded":x?"true":void 0,"aria-haspopup":"menu","aria-controls":g,id:p},h,{onClick:y},(i=r.componentsProps)==null?void 0:i.baseButton,{children:n.current.getLocaleText("toolbarDensity")})),e(he,{open:x,target:C.current,onClickAway:d,position:"bottom-start",children:e(te,{id:g,className:fe.menuList,"aria-labelledby":p,onKeyDown:a,autoFocusItem:x,children:f})})]})}),He=["componentsProps"],Ke=t=>{const{classes:o}=t;return N({root:["toolbarFilterList"]},W,o)},Ye=Q("ul",{name:"MuiDataGrid",slot:"ToolbarFilterList",overridesResolver:(t,o)=>o.toolbarFilterList})(({theme:t})=>({margin:t.spacing(1,1,.5),padding:t.spacing(0,1)})),Ze=c.forwardRef(function(o,u){var i,m;const{componentsProps:h={}}=o,n=I(o,He),r=h.button||{},s=_(),p=R(),g=L(s,Ce),x=L(s,ve),v=L(s,H),C=Ke(p),F=c.useMemo(()=>{if(v.open)return s.current.getLocaleText("toolbarFiltersTooltipHide");if(g.length===0)return s.current.getLocaleText("toolbarFiltersTooltipShow");const D=d=>x[d.columnField].filterOperators.find(w=>w.value===d.operatorValue).label||s.current.getLocaleText(`filterOperator${oe(d.operatorValue)}`).toString(),y=d=>{const{getValueAsString:w}=x[d.columnField].filterOperators.find(a=>a.value===d.operatorValue);return w?w(d.value):d.value};return k("div",{children:[s.current.getLocaleText("toolbarFiltersTooltipActive")(g.length),e(Ye,{className:C.root,ownerState:p,children:g.map((d,w)=>S({},x[d.columnField]&&e("li",{children:`${x[d.columnField].headerName||d.columnField}
                  ${D(d)}
                  ${d.value?y(d):""}`},w)))})]})},[s,p,v.open,g,x,C]),P=D=>{var y;const{open:d,openedPanelValue:w}=v;d&&w===M.filters?s.current.hideFilterPanel():s.current.showFilterPanel(),(y=r.onClick)==null||y.call(r,D)};return p.disableColumnFilter?null:e(p.components.BaseTooltip,S({title:F,enterDelay:1e3},n,(i=p.componentsProps)==null?void 0:i.baseTooltip,{children:e(p.components.BaseButton,S({ref:u,size:"small","aria-label":s.current.getLocaleText("toolbarFiltersLabel"),startIcon:e(ye,{badgeContent:g.length,color:"primary",children:e(p.components.OpenFilterButtonIcon,{})})},r,{onClick:P},(m=p.componentsProps)==null?void 0:m.baseButton,{children:s.current.getLocaleText("toolbarFilters")}))}))}),Je=["quickFilterParser","quickFilterFormatter","debounceMs"],Xe=Q(ne,{name:"MuiDataGrid",slot:"ToolbarQuickFilter",overridesResolver:(t,o)=>o.toolbarQuickFilter})(({theme:t})=>({width:"auto",paddingBottom:t.spacing(.5),"& input":{marginLeft:t.spacing(.5)},"& .MuiInput-underline:before":{borderBottom:`1px solid ${t.palette.divider}`},"& input[type=search]::-ms-clear,\n& input[type=search]::-ms-reveal":{display:"none",width:0,height:0},'& input[type="search"]::-webkit-search-decoration,\n  & input[type="search"]::-webkit-search-cancel-button,\n  & input[type="search"]::-webkit-search-results-button,\n  & input[type="search"]::-webkit-search-results-decoration':{display:"none"}})),et=t=>t.split(" ").filter(o=>o!==""),tt=t=>t.join(" ");function ot(t){var o;const{quickFilterParser:u=et,quickFilterFormatter:i=tt,debounceMs:m=500}=t,h=I(t,Je),n=_(),r=R(),s=L(n,we),[p,g]=c.useState(()=>i(s??[])),[x,v]=c.useState(s);c.useEffect(()=>{O(x,s)||(v(s),g(y=>O(u(y),s)?y:i(s??[])))},[x,s,i,u]);const C=c.useCallback(y=>{n.current.setQuickFilterValues(u(y))},[n,u]),F=c.useMemo(()=>re(C,m),[C,m]),P=c.useCallback(y=>{const d=y.target.value;g(d),F(d)},[F]),D=c.useCallback(()=>{g(""),C("")},[C]);return e(Xe,S({as:r.components.BaseTextField,ownerState:r,variant:"standard",value:p,onChange:P,placeholder:n.current.getLocaleText("toolbarQuickFilterPlaceholder"),"aria-label":n.current.getLocaleText("toolbarQuickFilterLabel"),type:"search",InputProps:{startAdornment:e(r.components.QuickFilterIcon,{fontSize:"small"}),endAdornment:e(j,{"aria-label":n.current.getLocaleText("toolbarQuickFilterDeleteIconLabel"),size:"small",sx:{visibility:p?"visible":"hidden"},onClick:D,children:e(r.components.QuickFilterClearIcon,{fontSize:"small"})})}},h,(o=r.componentsProps)==null?void 0:o.baseTextField))}const rt=["className","csvOptions","printOptions","excelOptions","showQuickFilter","quickFilterProps"],nt=c.forwardRef(function(o,u){const{csvOptions:i,printOptions:m,excelOptions:h,showQuickFilter:n=!1,quickFilterProps:r={}}=o,s=I(o,rt),p=R();return p.disableColumnFilter&&p.disableColumnSelector&&p.disableDensitySelector&&!n?null:k(Oe,S({ref:u},s,{children:[e(ze,{}),e(Ze,{}),e(We,{}),e(Se,{csvOptions:i,printOptions:m,excelOptions:h}),e(T,{sx:{flex:1}}),n&&e(ot,S({},r))]}))});var G={},z;function st(){if(z)return G;z=1;var t=se();Object.defineProperty(G,"__esModule",{value:!0}),G.default=void 0;var o=t(Fe()),u=ke;return G.default=(0,o.default)((0,u.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),G}var at=st();const lt=ae(at),Pt=()=>{const t=le();ie(t.palette.mode);const o=Pe(t.breakpoints.down("sm")),[u,i]=c.useState([]),[m,h]=c.useState(""),[n,r]=c.useState(!1),[s,p]=c.useState(null),[g,x]=c.useState(!0),[v,C]=c.useState(null),F=ce();c.useEffect(()=>{(async()=>{try{x(!0);const f=await fetch("http://localhost:3000/api/questions");if(!f.ok)throw new Error(`HTTP Error: ${f.status}`);const l=await f.json();if(!l.success||!Array.isArray(l.data))throw new Error("Invalid data format");const b=l.data.map(E=>({...E,audioUrl:E.audioUrl||null,answers:E.answers.map(V=>({...V,audioUrl:V.audioUrl||null}))}));i(b)}catch(f){console.error("Error:",f),C(f.message)}finally{x(!1)}})()},[]);const P=a=>{p(a),r(!0)},D=async()=>{try{if(!(await fetch(`http://localhost:3000/api/questions/${s}`,{method:"DELETE"})).ok)throw new Error("Error during deletion");h("Question deleted successfully"),i(u.filter(f=>f._id!==s))}catch(a){console.error("Error:",a),h(`Error: ${a.message}`)}finally{r(!1)}},y=()=>{F("/dashboard/contacts/new")},d=async a=>{const f=a.target.files[0];if(!f){h("Please select a CSV file");return}const l=new FormData;l.append("file",f);try{const b=await fetch("http://localhost:3000/api/questions/import",{method:"POST",body:l});if(!b.ok){const V=await b.text();throw new Error(`Error: ${b.status} - ${V}`)}const E=await b.json();h(E.message),window.location.reload()}catch(b){h(b.message),console.error("Upload error:",b)}},w=[{field:"questionText",headerName:"QUESTION",flex:1,minWidth:200,renderCell:a=>e(T,{sx:{width:"100%"},children:a.row.questionType==="oral"&&a.row.audioUrl?e("audio",{controls:!0,src:a.row.audioUrl,style:{width:"100%",maxWidth:"200px",height:"30px"}}):e(B,{variant:"body2",children:a.row.questionText})})},{field:"questionType",headerName:"TYPE",width:100,renderCell:a=>e(de,{label:a.row.questionType==="oral"?"Oral":"Written",sx:{fontSize:"0.8rem"}})},{field:"level",headerName:"LEVEL",width:120,renderCell:a=>{var f;return e(B,{variant:"body2",children:((f=a.row.level)==null?void 0:f.name)||a.row.level||"Not specified"})}},{field:"answers",headerName:"ANSWERS",flex:2,minWidth:300,renderCell:a=>{var f;return e(T,{sx:{width:"100%"},children:(f=a.row.answers)==null?void 0:f.map((l,b)=>e(T,{sx:{mb:1,p:1,borderRadius:"4px",backgroundColor:l.isCorrect?"#198754":"#ccc"},children:l.audioUrl?e("audio",{controls:!0,src:l.audioUrl,style:{height:"30px",minWidth:"100px"}}):e(B,{variant:"body2",color:l.isCorrect?"white":"black",children:l.text})},b))})}},{field:"actions",headerName:"ACTIONS",width:100,renderCell:a=>e(T,{sx:{display:"flex",gap:1},children:e(j,{onClick:()=>P(a.row._id),children:e(De,{fontSize:"small"})})})}];return g?e(T,{display:"flex",justifyContent:"center",alignItems:"center",height:"80vh",children:e(ue,{size:40})}):v?e(U,{severity:"error",sx:{fontSize:"1rem"},children:v}):k(T,{m:o?"10px":"20px",children:[e(pe,{title:"QUESTIONS",subtitle:"Question list"}),e(T,{display:"flex",justifyContent:"space-between",mb:2,flexDirection:o?"column":"row",gap:2,children:k(T,{display:"flex",gap:2,flexWrap:"wrap",children:[e("input",{accept:".csv",style:{display:"none"},id:"csv-upload",type:"file",onChange:d}),e("label",{htmlFor:"csv-upload",children:e(q,{variant:"contained",component:"span",sx:{fontSize:"0.9rem",py:1,px:2},children:"Import CSV"})}),e(q,{variant:"contained",startIcon:e(lt,{}),onClick:y,sx:{fontSize:"0.9rem",py:1,px:2},children:"New Question"})]})}),m&&e(U,{severity:m.includes("Error")?"error":"success",sx:{mb:2,fontSize:"1rem"},children:m}),e(T,{sx:{height:"70vh",width:"100%"},children:e(Te,{rows:u,columns:w,getRowId:a=>a._id,components:{Toolbar:nt},loading:g,pageSize:10,rowsPerPageOptions:[10,20,50],disableSelectionOnClick:!0,density:"compact",getRowHeight:()=>100,sx:{fontSize:"0.9rem"}})}),k(Re,{open:n,onClose:()=>r(!1),children:[e(Ee,{sx:{fontSize:"1rem"},children:"Confirm deletion"}),e($e,{children:e(_e,{sx:{fontSize:"0.9rem"},children:"Delete this question? This action is permanent."})}),k(Ge,{children:[e(q,{onClick:()=>r(!1),sx:{fontSize:"0.9rem"},children:"Cancel"}),e(q,{onClick:D,color:"error",variant:"contained",sx:{fontSize:"0.9rem"},children:"Delete"})]})]})]})};export{Pt as default};
