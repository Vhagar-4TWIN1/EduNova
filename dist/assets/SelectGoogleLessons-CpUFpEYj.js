import{r as n,u as v,j as a,a4 as c,b as t,a3 as r,a5 as y,a9 as I,a as i}from"./index-B07QrE09.js";import{B as g}from"./Button-C2CxUlaZ.js";import{S as w}from"./Stack-CzBGNAzc.js";import{F as B,C as L}from"./FormControlLabel-CBsZHJ14.js";import"./useThemeProps-Dr1Q7xUJ.js";import"./getThemeProps-C5bpZ834.js";const E=()=>{const[l,p]=n.useState([]),[s,m]=n.useState([]),[f,d]=n.useState(!0),[k,h]=n.useState(!1),x=v();n.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("token");if(!(await i.get("https://edunova-back-rqxc.onrender.com/api/google/check-auth",{headers:{Authorization:`Bearer ${o}`},withCredentials:!0})).data.authenticated){h(!0),d(!1);return}const b=await i.get("https://edunova-back-rqxc.onrender.com/api/google/lessons-temp",{headers:{Authorization:`Bearer ${o}`},withCredentials:!0});p(b.data)}catch(o){console.error("Error during check/fetch:",o),h(!0)}finally{d(!1)}})()},[]);const C=e=>{m(o=>o.includes(e)?o.filter(u=>u!==e):[...o,e])},A=async()=>{const e=localStorage.getItem("token");try{await i.post("https://edunova-back-rqxc.onrender.com/api/google/import-lessons",{lessonIds:s},{headers:{Authorization:`Bearer ${e}`},withCredentials:!0}),alert("✅ Selected lessons imported!"),x("/dashboard/lessons")}catch(o){console.error("❌ Import error:",o),alert("Import failed")}},S=()=>{window.location.href="https://edunova-back-rqxc.onrender.com/api/google/auth"};return f?a(c,{p:4,children:[t(r,{variant:"h5",children:"Checking Google Authentication..."}),t(y,{sx:{mt:2}})]}):k?a(c,{p:4,textAlign:"center",children:[t(r,{variant:"h5",gutterBottom:!0,children:"Google Authentication Required"}),t(r,{paragraph:!0,children:"You need to authenticate to fetch lessons."}),t(g,{variant:"contained",onClick:S,children:"Connect Google Classroom"})]}):a(c,{p:4,children:[t(r,{variant:"h4",gutterBottom:!0,children:"Select Lessons to Import from Google Classroom"}),l.length===0?t(r,{children:"No lessons found."}):t(w,{spacing:2,children:l.map(e=>t(I,{sx:{p:2},children:t(B,{control:t(L,{checked:s.includes(e._id),onChange:()=>C(e._id)}),label:a(c,{children:[t(r,{fontWeight:"bold",children:e.title||"Untitled"}),t(r,{variant:"body2",children:e.content||"No content"}),a(r,{variant:"caption",color:"text.secondary",children:["Type: ",e.typeLesson||"unknown"]})]})})},e._id))}),a(g,{variant:"contained",sx:{mt:3},disabled:s.length===0,onClick:A,children:["Import Selected Lessons (",s.length,")"]})]})};export{E as default};
