import{ai as J}from"./index-B07QrE09.js";import{b as Tn,s as Mn,l as Un,u as pn,t as Cn,c as Dn,p as xn,N as bn,d as wn}from"./utcTime-BNE41mvX.js";import{E as Fn,h as Yn,i as En,j as Sn,F as qn,G as Hn,H as kn,I as j}from"./_baseAssignValue-CO5KtFk2.js";var S,G;function In(){if(G)return S;G=1;var n=Tn();function e(t){return t&&t.length?n(t):[]}return S=e,S}var jn=In();const L=J(jn);var q,N;function _n(){if(N)return q;N=1;var n=Fn(),e=Yn(),t="[object Date]";function a(i){return e(i)&&n(i)==t}return q=a,q}var H,P;function On(){if(P)return H;P=1;var n=_n(),e=En(),t=Sn(),a=t&&t.isDate,i=a?e(a):n;return H=i,H}var Rn=On();const Wn=J(Rn);var k=new Date,I=new Date;function h(n,e,t,a){function i(r){return n(r=arguments.length===0?new Date:new Date(+r)),r}return i.floor=function(r){return n(r=new Date(+r)),r},i.ceil=function(r){return n(r=new Date(r-1)),e(r,1),n(r),r},i.round=function(r){var u=i(r),o=i.ceil(r);return r-u<o-r?u:o},i.offset=function(r,u){return e(r=new Date(+r),u==null?1:Math.floor(u)),r},i.range=function(r,u,o){var s=[],v;if(r=i.ceil(r),o=o==null?1:Math.floor(o),!(r<u)||!(o>0))return s;do s.push(v=new Date(+r)),e(r,o),n(r);while(v<r&&r<u);return s},i.filter=function(r){return h(function(u){if(u>=u)for(;n(u),!r(u);)u.setTime(u-1)},function(u,o){if(u>=u)if(o<0)for(;++o<=0;)for(;e(u,-1),!r(u););else for(;--o>=0;)for(;e(u,1),!r(u););})},t&&(i.count=function(r,u){return k.setTime(+r),I.setTime(+u),n(k),n(I),Math.floor(t(k,I))},i.every=function(r){return r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?i.filter(a?function(u){return a(u)%r===0}:function(u){return i.count(0,u)%r===0}):i}),i}var w=h(function(){},function(n,e){n.setTime(+n+e)},function(n,e){return e-n});w.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?h(function(e){e.setTime(Math.floor(e/n)*n)},function(e,t){e.setTime(+e+t*n)},function(e,t){return(t-e)/n}):w};w.range;var F=1e3,b=6e4,Y=36e5,K=6048e5,_=h(function(n){n.setTime(n-n.getMilliseconds())},function(n,e){n.setTime(+n+e*F)},function(n,e){return(e-n)/F},function(n){return n.getUTCSeconds()});_.range;var Q=h(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*F)},function(n,e){n.setTime(+n+e*b)},function(n,e){return(e-n)/b},function(n){return n.getMinutes()});Q.range;var X=h(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*F-n.getMinutes()*b)},function(n,e){n.setTime(+n+e*Y)},function(n,e){return(e-n)/Y},function(n){return n.getHours()});X.range;function p(n){return h(function(e){e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t*7)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*b)/K})}var O=p(0),B=p(1),Z=p(2),nn=p(3),en=p(4),tn=p(5),rn=p(6);O.range;B.range;Z.range;nn.range;en.range;tn.range;rn.range;var un=h(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,e){n.setMonth(n.getMonth()+e)},function(n,e){return e.getMonth()-n.getMonth()+(e.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()});un.range;var W=h(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e)},function(n,e){return e.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});W.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:h(function(e){e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t*n)})};W.range;var an=h(function(n){n.setUTCSeconds(0,0)},function(n,e){n.setTime(+n+e*b)},function(n,e){return(e-n)/b},function(n){return n.getUTCMinutes()});an.range;var on=h(function(n){n.setUTCMinutes(0,0,0)},function(n,e){n.setTime(+n+e*Y)},function(n,e){return(e-n)/Y},function(n){return n.getUTCHours()});on.range;function C(n){return h(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t*7)},function(e,t){return(t-e)/K})}var R=C(0),cn=C(1),sn=C(2),fn=C(3),ln=C(4),vn=C(5),mn=C(6);R.range;cn.range;sn.range;fn.range;ln.range;vn.range;mn.range;var gn=h(function(n){n.setUTCDate(1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCMonth(n.getUTCMonth()+e)},function(n,e){return e.getUTCMonth()-n.getUTCMonth()+(e.getUTCFullYear()-n.getUTCFullYear())*12},function(n){return n.getUTCMonth()});gn.range;var z=h(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e)},function(n,e){return e.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});z.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:h(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t*n)})};z.range;function U(){return U=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},U.apply(this,arguments)}var x=[function(n){return n.setMilliseconds(0)},function(n){return n.setSeconds(0)},function(n){return n.setMinutes(0)},function(n){return n.setHours(0)},function(n){return n.setDate(1)},function(n){return n.setMonth(0)}],zn={millisecond:[],second:x.slice(0,1),minute:x.slice(0,2),hour:x.slice(0,3),day:x.slice(0,4),month:x.slice(0,5),year:x.slice(0,6)},Gn=function(n){return function(e){return zn[n].forEach(function(t){t(e)}),e}},dn=function(n){var e=n.format,t=e===void 0?"native":e,a=n.precision,i=a===void 0?"millisecond":a,r=n.useUTC,u=r===void 0||r,o=Gn(i);return function(s){if(s===void 0)return s;if(t==="native"||s instanceof Date)return o(s);var v=u?Hn(t):kn(t);return o(v(s))}},Ln=function(n,e,t,a){var i,r,u,o,s=n.min,v=s===void 0?0:s,l=n.max,c=l===void 0?"auto":l,g=n.stacked,d=g!==void 0&&g,f=n.reverse,m=f!==void 0&&f,y=n.clamp,D=y!==void 0&&y,T=n.nice,M=T!==void 0&&T;v==="auto"?i=d===!0?(r=e.minStacked)!=null?r:0:e.min:i=v,c==="auto"?u=d===!0?(o=e.maxStacked)!=null?o:0:e.max:u=c;var E=qn().rangeRound(a==="x"?[0,t]:[t,0]).domain(m?[u,i]:[i,u]).clamp(D);return M===!0?E.nice():typeof M=="number"&&E.nice(M),Nn(E,d)},Nn=function(n,e){e===void 0&&(e=!1);var t=n;return t.type="linear",t.stacked=e,t},Pn=function(n,e,t){var a=xn().range([0,t]).domain(e.all);return a.type="point",a},Vn=function(n,e,t,a){var i=n.round,r=i===void 0||i,u=Dn().range(a==="x"?[0,t]:[t,0]).domain(e.all).round(r);return An(u)},An=function(n){var e=n;return e.type="band",e},$n=function(n,e,t){var a,i,r=n.format,u=r===void 0?"native":r,o=n.precision,s=o===void 0?"millisecond":o,v=n.min,l=v===void 0?"auto":v,c=n.max,g=c===void 0?"auto":c,d=n.useUTC,f=d===void 0||d,m=n.nice,y=m!==void 0&&m,D=dn({format:u,precision:s,useUTC:f});a=l==="auto"?D(e.min):u!=="native"?D(l):l,i=g==="auto"?D(e.max):u!=="native"?D(g):g;var T=f?pn():Cn();T.range([0,t]),a&&i&&T.domain([a,i]),y===!0?T.nice():typeof y!="object"&&typeof y!="number"||T.nice(y);var M=T;return M.type="time",M.useUTC=f,M},Jn=function(n,e,t,a){var i,r=n.base,u=r===void 0?10:r,o=n.min,s=o===void 0?"auto":o,v=n.max,l=v===void 0?"auto":v;if(e.all.some(function(m){return m===0}))throw new Error("a log scale domain must not include or cross zero");var c,g,d=!1;if(e.all.filter(function(m){return m!=null}).forEach(function(m){d||(i===void 0?i=Math.sign(m):Math.sign(m)!==i&&(d=!0))}),d)throw new Error("a log scale domain must be strictly-positive or strictly-negative");c=s==="auto"?e.min:s,g=l==="auto"?e.max:l;var f=Un().domain([c,g]).rangeRound(a==="x"?[0,t]:[t,0]).base(u).nice();return f.type="log",f},Kn=function(n,e,t,a){var i,r,u=n.constant,o=u===void 0?1:u,s=n.min,v=s===void 0?"auto":s,l=n.max,c=l===void 0?"auto":l,g=n.reverse,d=g!==void 0&&g;i=v==="auto"?e.min:v,r=c==="auto"?e.max:c;var f=Mn().constant(o).rangeRound(a==="x"?[0,t]:[t,0]).nice();d===!0?f.domain([r,i]):f.domain([i,r]);var m=f;return m.type="symlog",m},Qn=function(n){return n==="x"?"y":"x"},Xn=function(n,e){return n===e},Bn=function(n,e){return n.getTime()===e.getTime()};function V(n,e,t,a){switch(n.type){case"linear":return Ln(n,e,t,a);case"point":return Pn(n,e,t);case"band":return Vn(n,e,t,a);case"time":return $n(n,e,t);case"log":return Jn(n,e,t,a);case"symlog":return Kn(n,e,t,a);default:throw new Error("invalid scale spec")}}var A=function(n,e,t){var a;if("stacked"in t&&t.stacked){var i=n.data[e==="x"?"xStacked":"yStacked"];return i==null?null:t(i)}return(a=t(n.data[e]))!=null?a:null},oe=function(n,e,t,a,i){var r=n.map(function(l){return function(c){return U({},c,{data:c.data.map(function(g){return{data:U({},g)}})})}(l)}),u=Zn(r,e,t);"stacked"in e&&e.stacked===!0&&ne(u,r),"stacked"in t&&t.stacked===!0&&ee(u,r);var o=V(e,u.x,a,"x"),s=V(t,u.y,i,"y"),v=r.map(function(l){return U({},l,{data:l.data.map(function(c){return U({},c,{position:{x:A(c,"x",o),y:A(c,"y",s)}})})})});return U({},u,{series:v,xScale:o,yScale:s})},Zn=function(n,e,t){return{x:$(n,"x",e),y:$(n,"y",t)}},$=function(n,e,t,a){var i={},r=i.getValue,u=r===void 0?function(f){return f.data[e]}:r,o=i.setValue,s=o===void 0?function(f,m){f.data[e]=m}:o;if(t.type==="linear")n.forEach(function(f){f.data.forEach(function(m){var y=u(m);y&&s(m,parseFloat(String(y)))})});else if(t.type==="time"&&t.format!=="native"){var v=dn(t);n.forEach(function(f){f.data.forEach(function(m){var y=u(m);y&&s(m,v(y))})})}var l=[];switch(n.forEach(function(f){f.data.forEach(function(m){l.push(u(m))})}),t.type){case"linear":var c=wn(L(l).filter(function(f){return f!==null}),function(f){return f});return{all:c,min:Math.min.apply(Math,c),max:Math.max.apply(Math,c)};case"time":var g=bn(l,function(f){return f.getTime()}).slice(0).sort(function(f,m){return m.getTime()-f.getTime()}).reverse();return{all:g,min:g[0],max:j(g)};default:var d=L(l);return{all:d,min:d[0],max:j(d)}}},hn=function(n,e,t){var a=Qn(n),i=[];e[a].all.forEach(function(r){var u=Wn(r)?Bn:Xn,o=[];t.forEach(function(s){var v=s.data.find(function(d){return u(d.data[a],r)}),l=null,c=null;if(v!==void 0){if((l=v.data[n])!==null){var g=j(o);g===void 0?c=l:g!==null&&(c=g+l)}v.data[n==="x"?"xStacked":"yStacked"]=c}o.push(c),c!==null&&i.push(c)})}),e[n].minStacked=Math.min.apply(Math,i),e[n].maxStacked=Math.max.apply(Math,i)},ne=function(n,e){return hn("x",n,e)},ee=function(n,e){return hn("y",n,e)},ce=function(n){var e=n.bandwidth();if(e===0)return n;var t=e/2;return n.round()&&(t=Math.round(t)),function(a){var i;return((i=n(a))!=null?i:0)+t}},yn={millisecond:[w,w],second:[_,_],minute:[Q,an],hour:[X,on],day:[h(function(n){return n.setHours(0,0,0,0)},function(n,e){return n.setDate(n.getDate()+e)},function(n,e){return(e.getTime()-n.getTime())/864e5},function(n){return Math.floor(n.getTime()/864e5)}),h(function(n){return n.setUTCHours(0,0,0,0)},function(n,e){return n.setUTCDate(n.getUTCDate()+e)},function(n,e){return(e.getTime()-n.getTime())/864e5},function(n){return Math.floor(n.getTime()/864e5)})],week:[O,R],sunday:[O,R],monday:[B,cn],tuesday:[Z,sn],wednesday:[nn,fn],thursday:[en,ln],friday:[tn,vn],saturday:[rn,mn],month:[un,gn],year:[W,z]},te=Object.keys(yn),re=new RegExp("^every\\s*(\\d+)?\\s*("+te.join("|")+")s?$","i"),se=function(n,e){if(Array.isArray(e))return e;if(typeof e=="string"&&"useUTC"in n){var t=e.match(re);if(t){var a=t[1],i=t[2],r=yn[i][n.useUTC?1:0];if(i==="day"){var u,o,s=n.domain(),v=s[0],l=s[1],c=new Date(l);return c.setDate(c.getDate()+1),(u=(o=r.every(Number(a??1)))==null?void 0:o.range(v,c))!=null?u:[]}if(a===void 0)return n.ticks(r);var g=r.every(Number(a));if(g)return n.ticks(g)}throw new Error("Invalid tickValues: "+e)}if("ticks"in n){if(e===void 0)return n.ticks();if(typeof(d=e)=="number"&&isFinite(d)&&Math.floor(d)===d)return n.ticks(e)}var d;return n.domain()};export{V as c,oe as d,se as k,ce as p};
