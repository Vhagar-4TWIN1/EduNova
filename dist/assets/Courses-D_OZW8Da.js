import{r as a,u as j,j as o,b as t,a as y}from"./index-C3nL3Q8Y.js";const $=()=>{const[b,x]=a.useState([]),[m,g]=a.useState(""),[u,A]=a.useState("title"),[l,S]=a.useState({pdf:!0,video:!0,photo:!0,audio:!0}),[E,P]=a.useState({pdf:!0,video:!0,image:!0,audio:!0}),[s,w]=a.useState(""),d=localStorage.getItem("token"),c=localStorage.getItem("role"),C=localStorage.getItem("userId"),h=j(),[p,k]=a.useState(!1),[f,v]=a.useState(!1),[i,T]=a.useState(""),L=()=>{v(e=>!e)},z=async e=>{try{const r=await y.get(`http://localhost:3000/module/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("✅ Module fetched:",r.data),h(`/moduleDetails/${e}`)}catch(r){console.error("❌ Error fetching module details:",r)}},R=()=>{k(e=>!e)},F=async()=>{try{const e=await y.get("http://localhost:3000/api/lessons",{headers:{Authorization:`Bearer ${d}`}});x(e.data)}catch(e){console.error("Failed to fetch lessons:",e),g("Unauthorized or server error.")}},I=e=>{w(e.target.value)};a.useEffect(()=>{d?F():g("No token found. Please login.")},[d]);const B=[...b].filter(e=>{const r=l[e.typeLesson],n=!s||new Date(e.createdAt).toISOString().slice(0,10)===s,M=!p||e.userId===C,O=!f||new Date(e.createdAt)>=new Date(Date.now()-7*24*60*60*1e3),W=!i||e.title.toLowerCase().includes(i.toLowerCase())||e.content.toLowerCase().includes(i.toLowerCase());return r&&n&&M&&O&&W}).sort((e,r)=>u==="title"?e.title.localeCompare(r.title):u==="type"?e.typeLesson.localeCompare(r.typeLesson):0),D=e=>{S(r=>({...r,[e]:!r[e]}))};return o("div",{style:{display:"flex",backgroundColor:"#f0f4f8",minHeight:"100vh",paddingTop:"4rem",fontFamily:"'Poppins', sans-serif"},children:[o("aside",{style:{width:"260px",padding:"2rem 1.5rem",borderRight:"1px solid #e5e7eb",background:"#f9fafb",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.04)",display:"flex",flexDirection:"column",gap:"2rem"},children:[o("div",{children:[t("h2",{style:{fontSize:"1.1rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"🎯 Filter by Type"}),t("ul",{style:{listStyle:"none",padding:0},children:Object.keys(l).map(e=>t("li",{style:{marginBottom:"0.6rem"},children:o("label",{style:{cursor:"pointer",display:"flex",alignItems:"center"},children:[t("input",{type:"checkbox",checked:l[e],onChange:()=>D(e),style:{marginRight:"0.6rem"}}),t("span",{style:{fontWeight:500,fontSize:"0.95rem",textTransform:"capitalize",color:"#374151"},children:e})]})},e))})]}),o("div",{children:[t("h2",{style:{fontSize:"1.1rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"📅 Date"}),t("input",{type:"date",value:s,onChange:I,style:{padding:"0.5rem",borderRadius:"6px",border:"1px solid #d1d5db",width:"100%",fontSize:"0.9rem",color:"#374151"}})]}),o("div",{children:[t("h2",{style:{fontSize:"1.1rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"🔍 Filter by Keyword"}),t("input",{type:"text",placeholder:"e.g., web, frontend, backend...",value:i,onChange:e=>T(e.target.value),style:{padding:"0.5rem",borderRadius:"6px",border:"1px solid #d1d5db",width:"100%",fontSize:"0.9rem",color:"#374151"}})]}),c==="Teacher"&&o("div",{children:[t("h2",{style:{fontSize:"1.1rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"🧑 Created by Me"}),o("label",{style:{cursor:"pointer",display:"flex",alignItems:"center"},children:[t("input",{type:"checkbox",checked:p,onChange:R,style:{marginRight:"0.6rem"}}),t("span",{style:{fontSize:"0.9rem",color:"#374151"},children:"Show only my lessons"})]})]}),c==="Teacher"&&o("div",{children:[t("h2",{style:{fontSize:"1.1rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"🕒 Recent Uploads"}),o("label",{style:{cursor:"pointer",display:"flex",alignItems:"center"},children:[t("input",{type:"checkbox",checked:f,onChange:L,style:{marginRight:"0.6rem"}}),t("span",{style:{fontSize:"0.9rem",color:"#374151"},children:"Last 7 days only"})]})]}),c==="Teacher"&&t("button",{onClick:()=>h("/create-lesson"),style:{marginTop:"auto",padding:"0.75rem 1.2rem",backgroundColor:"#4fa54f",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontWeight:600,fontSize:"0.95rem",width:"100%",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.08)",transition:"background 0.3s"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#3d8a3d",onMouseOut:e=>e.currentTarget.style.backgroundColor="#4fa54f",children:"➕ Add Lesson"})]}),o("main",{style:{flex:1,padding:"2.5rem"},children:[t("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:t("h1",{style:{fontSize:"2rem",fontWeight:"700",color:"#1e3a8a"},children:"📚 All Lessons"})}),m&&t("div",{style:{backgroundColor:"#fee2e2",color:"#b91c1c",padding:"1rem",borderRadius:"0.5rem",marginBottom:"1rem",textAlign:"center"},children:m}),t("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",paddingTop:"2rem"},children:B.map(e=>{const r=e.moduleId||e.module||"";return o("div",{onClick:()=>h("/lesson-details",{state:{lesson:e,moduleId:r}}),style:{display:"flex",flexDirection:"column",border:"1px solid #e5e7eb",borderRadius:"1rem",backgroundColor:"#ffffff",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.05)",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.transform="translateY(-5px)",n.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1)"},onMouseLeave:n=>{n.currentTarget.style.transform="translateY(0)",n.currentTarget.style.boxShadow="0 8px 16px rgba(0,0,0,0.05)"},children:[t("div",{style:{height:"220px",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",overflow:"hidden"},children:t("img",{src:e.fileUrl||"/assets/img/default-course.jpg",alt:"Lesson Preview",style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})}),o("div",{style:{padding:"1.5rem"},children:[t("h2",{style:{fontSize:"1.3rem",fontWeight:"700",color:"#1f2937",marginBottom:"0.5rem",lineHeight:"1.4"},children:e.title}),o("p",{style:{fontSize:"0.95rem",color:"#4b5563",marginBottom:"0.25rem"},children:["Type: ",t("strong",{children:e.typeLesson.toUpperCase()})]}),o("p",{style:{fontSize:"0.9rem",color:"#6b7280",lineHeight:"1.5"},children:[e.content.slice(0,90),"..."]})]}),r&&t("button",{onClick:n=>{n.stopPropagation(),z(r)},style:{margin:"1rem",padding:"0.5rem 1rem",backgroundColor:"#2563eb",color:"#fff",border:"none",borderRadius:"0.5rem",fontWeight:"600",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.backgroundColor="#1e40af"},onMouseLeave:n=>{n.currentTarget.style.backgroundColor="#2563eb"},children:"Go to Module"})]},e._id)})})]})]})};export{$ as default};
