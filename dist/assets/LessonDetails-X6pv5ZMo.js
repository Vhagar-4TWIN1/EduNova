import{r as R,W as G,_ as Y,aV as Z,E as P,a3 as i,b as r,j as n,Z as J,V as K,a0 as Q,ak as f,ai as v,aF as X,u as ee,a4 as q,ab as M,ae as H,cu as re,cv as te,a as V,a9 as ae,l as oe,ar as ie}from"./index-C3nL3Q8Y.js";import{r as y,a as g}from"./jsx-runtime_commonjs-proxy-P7gUQ3kO.js";import{C as ne}from"./Card-BM1iOIYZ.js";import{C as se}from"./CardHeader-CEqvS9Zm.js";import{C as ce}from"./CardContent-DB49xfDB.js";import{T as z}from"./Tooltip-BYEiyJU_.js";import{L as de}from"./ListItemIcon-B0w8Y66k.js";import{b as le,a as B}from"./listItemTextClasses-B7Ux6p96.js";import{B as ue}from"./Button-Dg9Z3r8Z.js";import{S}from"./Stack-CAonYs3f.js";import"./useThemeProps-CRU2mqAJ.js";import"./getThemeProps-DLbyqOGa.js";const pe=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],me=t=>{const{classes:a,inset:e,primary:l,secondary:p,dense:m}=t;return Q({root:["root",e&&"inset",m&&"dense",l&&p&&"multiline"],primary:["primary"],secondary:["secondary"]},le,a)},he=J("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:e}=t;return[{[`& .${B.primary}`]:a.primary},{[`& .${B.secondary}`]:a.secondary},a.root,e.inset&&a.inset,e.primary&&e.secondary&&a.multiline,e.dense&&a.dense]}})(({ownerState:t})=>P({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})),fe=R.forwardRef(function(a,e){const l=G({props:a,name:"MuiListItemText"}),{children:p,className:m,disableTypography:u=!1,inset:C=!1,primary:k,primaryTypographyProps:x,secondary:T,secondaryTypographyProps:j}=l,o=Y(l,pe),{dense:s}=R.useContext(Z);let d=k??p,c=T;const h=P({},l,{disableTypography:u,inset:C,primary:!!d,secondary:!!c,dense:s}),D=me(h);return d!=null&&d.type!==i&&!u&&(d=r(i,P({variant:s?"body2":"body1",className:D.primary,component:x!=null&&x.variant?void 0:"span",display:"block"},x,{children:d}))),c!=null&&c.type!==i&&!u&&(c=r(i,P({variant:"body2",className:D.secondary,color:"text.secondary",display:"block"},j,{children:c}))),n(he,P({className:K(D.root,m),ownerState:h,ref:e},o,{children:[d,c]}))});var b={},F;function ve(){if(F)return b;F=1;var t=f();Object.defineProperty(b,"__esModule",{value:!0}),b.default=void 0;var a=t(y()),e=g;return b.default=(0,a.default)((0,e.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf"),b}var ye=ve();const U=v(ye);var I={},E;function ge(){if(E)return I;E=1;var t=f();Object.defineProperty(I,"__esModule",{value:!0}),I.default=void 0;var a=t(y()),e=g;return I.default=(0,a.default)((0,e.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8 12.5v-9l6 4.5z"}),"VideoLibrary"),I}var xe=ge();const be=v(xe);var L={},$;function Ie(){if($)return L;$=1;var t=f();Object.defineProperty(L,"__esModule",{value:!0}),L.default=void 0;var a=t(y()),e=g;return L.default=(0,a.default)((0,e.jsx)("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3z"}),"Audiotrack"),L}var Le=Ie();const _e=v(Le);var _={},N;function we(){if(N)return _;N=1;var t=f();Object.defineProperty(_,"__esModule",{value:!0}),_.default=void 0;var a=t(y()),e=g;return _.default=(0,a.default)((0,e.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image"),_}var Ae=we();const Pe=v(Ae);var w={},W;function Re(){if(W)return w;W=1;var t=f();Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var a=t(y()),e=g;return w.default=(0,a.default)((0,e.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),w}var ke=Re();const je=v(ke);var A={},O;function Ce(){if(O)return A;O=1;var t=f();Object.defineProperty(A,"__esModule",{value:!0}),A.default=void 0;var a=t(y()),e=g;return A.default=(0,a.default)((0,e.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),A}var Te=Ce();const De=v(Te),We=()=>{var j;const{id:t}=X(),a=ee(),[e,l]=R.useState(null),[p,m]=R.useState(!1),u=async()=>{try{const o=localStorage.getItem("token"),s=await V.get(`http://localhost:3000/api/lessons/${t}`,{headers:{Authorization:`Bearer ${o}`}});l(s.data)}catch(o){console.error("Failed to load lesson:",o)}};R.useEffect(()=>{u()},[t]);const C=async()=>{try{m(!0);const o=localStorage.getItem("token"),s=await V.post(`http://localhost:3000/api/lessons/${t}/generate-ai-annotations`,{},{headers:{Authorization:`Bearer ${o}`}});console.log("AI annotations response:",s.data)}catch(o){console.error("Failed to generate AI annotations:",o)}finally{m(!1),await u(),console.log("Annotation generation process finished and lesson re-fetched.")}},k=o=>o.includes("pdf")?r(U,{color:"error"}):o.includes("video")?r(be,{color:"primary"}):o.includes("image")?r(Pe,{color:"secondary"}):o.includes("audio")?r(_e,{color:"success"}):r(U,{}),x=()=>{const o=e==null?void 0:e.fileUrl;if(!o)return null;if(e.typeLesson==="video")return n("video",{controls:!0,width:"100%",style:{borderRadius:8,marginTop:16},children:[r("source",{src:o,type:"video/mp4"}),"Your browser does not support the video tag."]});if(e.typeLesson==="audio")return n("audio",{controls:!0,style:{width:"100%",marginTop:16},children:[r("source",{src:o,type:"audio/mpeg"}),"Your browser does not support the audio tag."]});if(e.typeLesson==="photo"||e.typeLesson==="image")return r("img",{src:o,alt:"Lesson media",style:{maxWidth:"100%",marginTop:16,borderRadius:8}});if(e.typeLesson==="pdf"){const s=`https://docs.google.com/gview?url=${encodeURIComponent(o)}&embedded=true`;return r("iframe",{src:s,title:"PDF Viewer",width:"100%",height:"600",style:{marginTop:16,borderRadius:8,border:"none"}})}return null},T=()=>{var o;return(o=e==null?void 0:e.annotations)!=null&&o.length?r(S,{spacing:2,mt:2,children:e.annotations.map((s,d)=>n(ae,{sx:{p:2,borderLeft:"4px solid #1976d2"},children:[s.userId&&n(oe,{children:[r(i,{variant:"subtitle2",fontWeight:600,children:"User ID:"}),r(i,{variant:"body2",gutterBottom:!0,children:s.userId})]}),r(i,{variant:"subtitle2",fontWeight:600,children:"Highlights:"}),r(S,{direction:"row",spacing:1,flexWrap:"wrap",children:s.highlights.map((c,h)=>r(ie,{label:c.text,sx:{backgroundColor:c.color||"#e0e0e0",color:"#000"}},h))}),r(i,{variant:"subtitle2",mt:1,fontWeight:600,children:"Notes:"}),s.notes.map((c,h)=>n(i,{variant:"body2",sx:{mt:.5},children:["• ",c.content," ",n("em",{style:{fontSize:12,color:"#888"},children:["(",new Date(c.createdAt).toLocaleString(),")"]})]},h))]},d))}):r(i,{children:"No annotations yet."})};return n(q,{m:4,children:[r(M,{onClick:()=>a(-1),children:r(De,{})}),n(ne,{sx:{mt:2,p:3,borderRadius:3,boxShadow:3},children:[r(se,{title:r(i,{variant:"h5",children:(e==null?void 0:e.title)||"Lesson Details"}),subheader:n(i,{variant:"subtitle2",children:["Type: ",e==null?void 0:e.typeLesson]})}),n(ce,{children:[r(H,{sx:{mb:2}}),r(i,{variant:"h6",gutterBottom:!0,children:"📚 Lesson Content:"}),r(i,{variant:"body1",mb:3,children:e==null?void 0:e.content}),r(H,{sx:{my:3}}),r(i,{variant:"h6",gutterBottom:!0,children:"📎 File Information:"}),r(re,{children:n(te,{children:[r(z,{title:"File Type",children:r(de,{children:k((e==null?void 0:e.fileUrl)||"")})}),r(fe,{primary:((j=e==null?void 0:e.fileUrl)==null?void 0:j.split("/").pop())||"Unnamed File",secondary:e==null?void 0:e.fileUrl}),r(z,{title:"Download File",children:n(M,{onClick:()=>window.open(e==null?void 0:e.fileUrl,"_blank"),children:[" ",r(je,{})," "]})})]})}),x(),r(H,{sx:{my:3}}),n(q,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[r(i,{variant:"h6",children:"📝 Annotations:"}),r(ue,{variant:"outlined",size:"small",onClick:C,disabled:p,children:p?"Generating...":"Generate AI Annotations"})]}),T()]})]})]})};export{We as default};
