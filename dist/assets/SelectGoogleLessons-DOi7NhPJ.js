import{r as n,u as I,j as r,a4 as c,b as e,a3 as a,a5 as w,a9 as b,a as l}from"./index-C3nL3Q8Y.js";import{B as g}from"./Button-Dg9Z3r8Z.js";import{S as B}from"./Stack-CAonYs3f.js";import{F as v,C as L}from"./FormControlLabel-BHfDsEEE.js";import"./useThemeProps-CRU2mqAJ.js";import"./getThemeProps-DLbyqOGa.js";const R=()=>{const[i,p]=n.useState([]),[s,m]=n.useState([]),[f,h]=n.useState(!0),[k,d]=n.useState(!1),C=I();n.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("token");if(!(await l.get("https://edunova-back-rqxc.onrender.com/api/google/check-auth",{headers:{Authorization:`Bearer ${o}`},withCredentials:!0})).data.authenticated){d(!0),h(!1);return}const y=await l.get("https://edunova-back-rqxc.onrender.com/api/google/lessons-temp",{headers:{Authorization:`Bearer ${o}`},withCredentials:!0});p(y.data)}catch(o){console.error("Error during check/fetch:",o),d(!0)}finally{h(!1)}})()},[]);const A=t=>{m(o=>o.includes(t)?o.filter(u=>u!==t):[...o,t])},S=async()=>{const t=localStorage.getItem("token");try{await l.post("https://edunova-back-rqxc.onrender.com/api/google/import-lessons",{lessonIds:s},{headers:{Authorization:`Bearer ${t}`},withCredentials:!0}),alert("✅ Selected lessons imported!"),C("/dashboard/lessons")}catch(o){console.error("❌ Import error:",o),alert("Import failed")}},x=()=>{window.location.href="https://edunova-back-rqxc.onrender.com/api/google/auth"};return f?r(c,{p:4,children:[e(a,{variant:"h5",children:"Checking Google Authentication..."}),e(w,{sx:{mt:2}})]}):k?r(c,{p:4,textAlign:"center",children:[e(a,{variant:"h5",gutterBottom:!0,children:"Google Authentication Required"}),e(a,{paragraph:!0,children:"You need to authenticate to fetch lessons."}),e(g,{variant:"contained",onClick:x,children:"Connect Google Classroom"})]}):r(c,{p:4,children:[e(a,{variant:"h4",gutterBottom:!0,children:"Select Lessons to Import from Google Classroom"}),i.length===0?e(a,{children:"No lessons found."}):e(B,{spacing:2,children:i.map(t=>e(b,{sx:{p:2},children:e(v,{control:e(L,{checked:s.includes(t._id),onChange:()=>A(t._id)}),label:r(c,{children:[e(a,{fontWeight:"bold",children:t.title||"Untitled"}),e(a,{variant:"body2",children:t.content||"No content"}),r(a,{variant:"caption",color:"text.secondary",children:["Type: ",t.typeLesson||"unknown"]})]})})},t._id))}),r(g,{variant:"contained",sx:{mt:3},disabled:s.length===0,onClick:S,children:["Import Selected Lessons (",s.length,")"]})]})};export{R as default};
