import{b as R,g as f,i as G,u as Y}from"./vendor-gGFwV6Yc.js";import{R as Q,_ as X,aN as J,B as P,$ as i,b as r,j as n,V as K,Q as Z,X as ee,ae as v,a0 as H,a7 as M,aa as D,ci as re,cj as te,a as B,a5 as oe,h as ae,al as ie}from"./index-CNYIw3Ap.js";import{r as y,a as g}from"./jsx-runtime_commonjs-proxy-B8aGQats.js";import{C as ne}from"./Card-BV5SPX1h.js";import{C as se}from"./CardHeader-CJlU9foh.js";import{C as ce}from"./CardContent-B6nDGSXF.js";import{T as V}from"./Tooltip-B-g2_8m6.js";import{L as de}from"./ListItemIcon-CIENBamt.js";import{b as le,a as z}from"./listItemTextClasses-DelaPf-g.js";import{B as ue}from"./Button-q5rqdzgK.js";import{S}from"./Stack-BLMnx7VC.js";import"./useThemeProps-C1R061y2.js";import"./getThemeProps-DCO5hL5C.js";const pe=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],me=t=>{const{classes:o,inset:e,primary:l,secondary:p,dense:m}=t;return ee({root:["root",e&&"inset",m&&"dense",l&&p&&"multiline"],primary:["primary"],secondary:["secondary"]},le,o)},he=K("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:e}=t;return[{[`& .${z.primary}`]:o.primary},{[`& .${z.secondary}`]:o.secondary},o.root,e.inset&&o.inset,e.primary&&e.secondary&&o.multiline,e.dense&&o.dense]}})(({ownerState:t})=>P({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})),fe=R.forwardRef(function(o,e){const l=Q({props:o,name:"MuiListItemText"}),{children:p,className:m,disableTypography:u=!1,inset:q=!1,primary:k,primaryTypographyProps:x,secondary:C,secondaryTypographyProps:j}=l,a=X(l,pe),{dense:s}=R.useContext(J);let d=k??p,c=C;const h=P({},l,{disableTypography:u,inset:q,primary:!!d,secondary:!!c,dense:s}),T=me(h);return d!=null&&d.type!==i&&!u&&(d=r(i,P({variant:s?"body2":"body1",className:T.primary,component:x!=null&&x.variant?void 0:"span",display:"block"},x,{children:d}))),c!=null&&c.type!==i&&!u&&(c=r(i,P({variant:"body2",className:T.secondary,color:"text.secondary",display:"block"},j,{children:c}))),n(he,P({className:Z(T.root,m),ownerState:h,ref:e},a,{children:[d,c]}))});var b={},U;function ve(){if(U)return b;U=1;var t=v();Object.defineProperty(b,"__esModule",{value:!0}),b.default=void 0;var o=t(y()),e=g;return b.default=(0,o.default)((0,e.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf"),b}var ye=ve();const F=f(ye);var I={},$;function ge(){if($)return I;$=1;var t=v();Object.defineProperty(I,"__esModule",{value:!0}),I.default=void 0;var o=t(y()),e=g;return I.default=(0,o.default)((0,e.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8 12.5v-9l6 4.5z"}),"VideoLibrary"),I}var xe=ge();const be=f(xe);var L={},E;function Ie(){if(E)return L;E=1;var t=v();Object.defineProperty(L,"__esModule",{value:!0}),L.default=void 0;var o=t(y()),e=g;return L.default=(0,o.default)((0,e.jsx)("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3z"}),"Audiotrack"),L}var Le=Ie();const _e=f(Le);var _={},N;function we(){if(N)return _;N=1;var t=v();Object.defineProperty(_,"__esModule",{value:!0}),_.default=void 0;var o=t(y()),e=g;return _.default=(0,o.default)((0,e.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image"),_}var Ae=we();const Pe=f(Ae);var w={},W;function Re(){if(W)return w;W=1;var t=v();Object.defineProperty(w,"__esModule",{value:!0}),w.default=void 0;var o=t(y()),e=g;return w.default=(0,o.default)((0,e.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),w}var ke=Re();const je=f(ke);var A={},O;function qe(){if(O)return A;O=1;var t=v();Object.defineProperty(A,"__esModule",{value:!0}),A.default=void 0;var o=t(y()),e=g;return A.default=(0,o.default)((0,e.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack"),A}var Ce=qe();const Te=f(Ce),Oe=()=>{var j;const{id:t}=G(),o=Y(),[e,l]=R.useState(null),[p,m]=R.useState(!1),u=async()=>{try{const a=localStorage.getItem("token"),s=await B.get(`https://edunova-back-rqxc.onrender.com/api/lessons/${t}`,{headers:{Authorization:`Bearer ${a}`}});l(s.data)}catch(a){console.error("Failed to load lesson:",a)}};R.useEffect(()=>{u()},[t]);const q=async()=>{try{m(!0);const a=localStorage.getItem("token"),s=await B.post(`https://edunova-back-rqxc.onrender.com/api/lessons/${t}/generate-ai-annotations`,{},{headers:{Authorization:`Bearer ${a}`}});console.log("AI annotations response:",s.data)}catch(a){console.error("Failed to generate AI annotations:",a)}finally{m(!1),await u(),console.log("Annotation generation process finished and lesson re-fetched.")}},k=a=>a.includes("pdf")?r(F,{color:"error"}):a.includes("video")?r(be,{color:"primary"}):a.includes("image")?r(Pe,{color:"secondary"}):a.includes("audio")?r(_e,{color:"success"}):r(F,{}),x=()=>{const a=e==null?void 0:e.fileUrl;if(!a)return null;if(e.typeLesson==="video")return n("video",{controls:!0,width:"100%",style:{borderRadius:8,marginTop:16},children:[r("source",{src:a,type:"video/mp4"}),"Your browser does not support the video tag."]});if(e.typeLesson==="audio")return n("audio",{controls:!0,style:{width:"100%",marginTop:16},children:[r("source",{src:a,type:"audio/mpeg"}),"Your browser does not support the audio tag."]});if(e.typeLesson==="photo"||e.typeLesson==="image")return r("img",{src:a,alt:"Lesson media",style:{maxWidth:"100%",marginTop:16,borderRadius:8}});if(e.typeLesson==="pdf"){const s=`https://docs.google.com/gview?url=${encodeURIComponent(a)}&embedded=true`;return r("iframe",{src:s,title:"PDF Viewer",width:"100%",height:"600",style:{marginTop:16,borderRadius:8,border:"none"}})}return null},C=()=>{var a;return(a=e==null?void 0:e.annotations)!=null&&a.length?r(S,{spacing:2,mt:2,children:e.annotations.map((s,d)=>n(oe,{sx:{p:2,borderLeft:"4px solid #1976d2"},children:[s.userId&&n(ae,{children:[r(i,{variant:"subtitle2",fontWeight:600,children:"User ID:"}),r(i,{variant:"body2",gutterBottom:!0,children:s.userId})]}),r(i,{variant:"subtitle2",fontWeight:600,children:"Highlights:"}),r(S,{direction:"row",spacing:1,flexWrap:"wrap",children:s.highlights.map((c,h)=>r(ie,{label:c.text,sx:{backgroundColor:c.color||"#e0e0e0",color:"#000"}},h))}),r(i,{variant:"subtitle2",mt:1,fontWeight:600,children:"Notes:"}),s.notes.map((c,h)=>n(i,{variant:"body2",sx:{mt:.5},children:["• ",c.content," ",n("em",{style:{fontSize:12,color:"#888"},children:["(",new Date(c.createdAt).toLocaleString(),")"]})]},h))]},d))}):r(i,{children:"No annotations yet."})};return n(H,{m:4,children:[r(M,{onClick:()=>o(-1),children:r(Te,{})}),n(ne,{sx:{mt:2,p:3,borderRadius:3,boxShadow:3},children:[r(se,{title:r(i,{variant:"h5",children:(e==null?void 0:e.title)||"Lesson Details"}),subheader:n(i,{variant:"subtitle2",children:["Type: ",e==null?void 0:e.typeLesson]})}),n(ce,{children:[r(D,{sx:{mb:2}}),r(i,{variant:"h6",gutterBottom:!0,children:"📚 Lesson Content:"}),r(i,{variant:"body1",mb:3,children:e==null?void 0:e.content}),r(D,{sx:{my:3}}),r(i,{variant:"h6",gutterBottom:!0,children:"📎 File Information:"}),r(re,{children:n(te,{children:[r(V,{title:"File Type",children:r(de,{children:k((e==null?void 0:e.fileUrl)||"")})}),r(fe,{primary:((j=e==null?void 0:e.fileUrl)==null?void 0:j.split("/").pop())||"Unnamed File",secondary:e==null?void 0:e.fileUrl}),r(V,{title:"Download File",children:n(M,{onClick:()=>window.open(e==null?void 0:e.fileUrl,"_blank"),children:[" ",r(je,{})," "]})})]})}),x(),r(D,{sx:{my:3}}),n(H,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[r(i,{variant:"h6",children:"📝 Annotations:"}),r(ue,{variant:"outlined",size:"small",onClick:q,disabled:p,children:p?"Generating...":"Generate AI Annotations"})]}),C()]})]})]})};export{Oe as default};
